Files already downloaded and verified
Files already downloaded and verified
Epoch 1
Test Accuracy: 64.55%
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 193156 KiB | 332937 KiB |   7646 GiB |   7646 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 193156 KiB | 332937 KiB |   7646 GiB |   7646 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 191594 KiB | 326108 KiB |   7537 GiB |   7537 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 358400 KiB | 358400 KiB | 358400 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23931 KiB | 159746 KiB |   5503 GiB |   5503 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     313    |     584    |    5611 K  |    5611 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     313    |     584    |    5611 K  |    5611 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      28    |      28    |      28    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      40    |      57    |    2216 K  |    2216 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Epoch 2
Test Accuracy: 75.22%
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 193156 KiB | 332937 KiB |   8008 GiB |   8008 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 193156 KiB | 332937 KiB |   8008 GiB |   8008 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 191594 KiB | 326108 KiB |   7896 GiB |   7896 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 358400 KiB | 358400 KiB | 358400 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  21883 KiB | 159746 KiB |   5793 GiB |   5793 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     313    |     584    |    5874 K  |    5874 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     313    |     584    |    5874 K  |    5874 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      28    |      28    |      28    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      37    |      57    |    2330 K  |    2330 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Epoch 3
Test Accuracy: 78.83%
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 193156 KiB | 332937 KiB |   8371 GiB |   8371 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 193156 KiB | 332937 KiB |   8371 GiB |   8371 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 191594 KiB | 326108 KiB |   8255 GiB |   8255 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 358400 KiB | 358400 KiB | 358400 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  21883 KiB | 159746 KiB |   6083 GiB |   6083 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     313    |     584    |    6137 K  |    6137 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     313    |     584    |    6137 K  |    6137 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      28    |      28    |      28    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      37    |      57    |    2445 K  |    2445 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Epoch 4
Test Accuracy: 78.00%
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 193156 KiB | 332937 KiB |   8733 GiB |   8733 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 193156 KiB | 332937 KiB |   8733 GiB |   8733 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 191594 KiB | 326108 KiB |   8613 GiB |   8613 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 358400 KiB | 358400 KiB | 358400 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  21883 KiB | 159746 KiB |   6372 GiB |   6372 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     313    |     584    |    6400 K  |    6400 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     313    |     584    |    6400 K  |    6400 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      28    |      28    |      28    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      37    |      57    |    2560 K  |    2560 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Epoch 5
Test Accuracy: 79.61%
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 193156 KiB | 332937 KiB |   9096 GiB |   9095 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 193156 KiB | 332937 KiB |   9096 GiB |   9095 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 191594 KiB | 326108 KiB |   8972 GiB |   8972 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 358400 KiB | 358400 KiB | 358400 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  21883 KiB | 159746 KiB |   6661 GiB |   6661 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     313    |     584    |    6663 K  |    6663 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     313    |     584    |    6663 K  |    6663 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      28    |      28    |      28    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      37    |      57    |    2674 K  |    2674 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Epoch 6
Test Accuracy: 79.74%
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 193156 KiB | 332937 KiB |   9458 GiB |   9458 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 193156 KiB | 332937 KiB |   9458 GiB |   9458 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 191594 KiB | 326108 KiB |   9331 GiB |   9331 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 358400 KiB | 358400 KiB | 358400 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  21883 KiB | 159746 KiB |   6951 GiB |   6951 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     313    |     584    |    6926 K  |    6926 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     313    |     584    |    6926 K  |    6926 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      28    |      28    |      28    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      37    |      57    |    2789 K  |    2789 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Epoch 7
Test Accuracy: 80.23%
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 193156 KiB | 332937 KiB |   9820 GiB |   9820 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 193156 KiB | 332937 KiB |   9820 GiB |   9820 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 191594 KiB | 326108 KiB |   9690 GiB |   9689 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 358400 KiB | 358400 KiB | 358400 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  21883 KiB | 159746 KiB |   7240 GiB |   7240 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     313    |     584    |    7189 K  |    7189 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     313    |     584    |    7189 K  |    7189 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      28    |      28    |      28    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      37    |      57    |    2904 K  |    2903 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Epoch 8
Test Accuracy: 79.96%
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 193156 KiB | 332937 KiB |  10183 GiB |  10183 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 193156 KiB | 332937 KiB |  10183 GiB |  10183 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 191594 KiB | 326108 KiB |  10048 GiB |  10048 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 358400 KiB | 358400 KiB | 358400 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  21883 KiB | 159746 KiB |   7530 GiB |   7530 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     313    |     584    |    7452 K  |    7452 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     313    |     584    |    7452 K  |    7452 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      28    |      28    |      28    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      37    |      57    |    3018 K  |    3018 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Epoch 9
Test Accuracy: 81.97%
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 193156 KiB | 332937 KiB |  10545 GiB |  10545 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 193156 KiB | 332937 KiB |  10545 GiB |  10545 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 191594 KiB | 326108 KiB |  10407 GiB |  10407 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 358400 KiB | 358400 KiB | 358400 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  21883 KiB | 159746 KiB |   7819 GiB |   7819 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     313    |     584    |    7715 K  |    7714 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     313    |     584    |    7715 K  |    7714 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      28    |      28    |      28    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      37    |      57    |    3133 K  |    3133 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Epoch 10
Test Accuracy: 83.17%
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 193156 KiB | 332937 KiB |  10908 GiB |  10907 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 193156 KiB | 332937 KiB |  10908 GiB |  10907 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 191594 KiB | 326108 KiB |  10766 GiB |  10765 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 358400 KiB | 358400 KiB | 358400 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  21883 KiB | 159746 KiB |   8109 GiB |   8109 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     313    |     584    |    7978 K  |    7977 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     313    |     584    |    7978 K  |    7977 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      28    |      28    |      28    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      37    |      57    |    3247 K  |    3247 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Model saved as resnet18_cifar10.pth
Model converted to ONNX: resnet18_cifar10.onnx
ONNX model is valid!
ONNX Inference Time: 16.81 seconds
Input 0: Name=input, Shape=(1, 3, 32, 32), Type=DataType.FLOAT
✅ ONNX Model exported successfully.
✅ ONNX model successfully parsed by TensorRT.
✅ FP16 Enabled for TensorRT Inference
✅ TensorRT Engine saved: resnet18_cifar10.trt
/usr/local/lib/python3.10/dist-packages/google/colab/_variable_inspector.py:27: UserWarning: device_allocation in out-of-thread context could not be cleaned up
  globals().clear()
/usr/local/lib/python3.10/dist-packages/google/colab/_variable_inspector.py:27: UserWarning: stream in out-of-thread context could not be cleaned up
  globals().clear()
ONNX Inference Time: 17.26 seconds
TensorRT Inference Time: 6.75 seconds
TensorRT Speedup over ONNX: 2.56x
